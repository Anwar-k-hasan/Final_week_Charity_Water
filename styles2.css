:root{
  --brand-yellow:#F7D21B;
  --brand-blue:#2CA6FF;
  --brand-green:#10b981;
  --ink:#0f172a;
  --muted:#e5e7eb;
  --card:#f8fafc;
  --grid:#d1d5db;
  --accent:#10b981;
  --danger:#ef4444;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  color:var(--ink);
  background:linear-gradient(180deg,#ffffff,#f3f4f6);
  display:flex; align-items:center; justify-content:center;
}
.app{width:min(920px,94vw); min-height:80vh; background:#fff; border:1px solid #e5e7eb; border-radius:20px; box-shadow:0 12px 40px rgba(2,6,23,.08); overflow:hidden}

header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:28px 22px;
  min-height:84px;
  border-bottom:1px solid #eef2f7;
  font-family: "Kazimir", serif !important;
}
.logo{display:flex; align-items:center; gap:10px; font-weight:800}
.drop{
  width:120px;
  height:44px;
  border-radius:10px;
  display:grid;
  place-items:center;
  font-size:20px;
}
.title-text{
  font-size:1.05rem;
  line-height:1;
  font-family: "Kazimir", serif !important;
}

.timer {
  font-family: "Kazimir", serif !important;
  font-weight: bold;
  font-size: 1rem;
}

.screen{display:none; padding:24px}
.screen.active{display:block}
.title{display:grid; place-items:center; gap:22px; text-align:center; padding:60px 20px}
.title h1{
  margin:0;
  font-family: "Kazimir", serif !important;
}
.subtitle{opacity:.8; max-width:60ch}
.difficulty-buttons{display:flex; gap:12px; flex-wrap:wrap; justify-content:center}
.buttons{display:flex; gap:12px; flex-wrap:wrap; justify-content:center}
.btn{padding:12px 16px; border-radius:14px; border:1px solid #e5e7eb; background:#fff; cursor:pointer; font-weight:700}
.btn.primary{background:var(--brand-blue); color:#fff; border-color:var(--brand-blue)}
.btn.secondary{background:#fff}
.btn:focus{outline:3px solid #a5d8ff}
.charity-tag{opacity:.7}

.gridWrap{display:grid; place-items:center; gap:14px}

/* Dynamic grid sizing */
.grid{
  display: grid;
  gap: 6px;
  justify-content: center;
  background: var(--card);
  padding: 12px;
  border-radius: 16px;
  border: 1px solid var(--grid);
  margin: 0 auto;
}

.grid.easy {
  grid-template-columns: repeat(5, minmax(56px, 80px));
  max-width: calc(5 * 80px + 4 * 6px + 24px);
}

.grid.medium {
  grid-template-columns: repeat(7, minmax(40px, 60px));
  max-width: calc(7 * 60px + 6 * 6px + 24px);
}

.grid.hard {
  grid-template-columns: repeat(9, minmax(30px, 50px));
  max-width: calc(9 * 50px + 8 * 6px + 24px);
}

.cell{
  width: 100%;
  aspect-ratio:1;
  background:#fff;
  border:1px solid var(--grid);
  border-radius:8px;
  display:grid;
  place-items:center;
  cursor:pointer;
  position:relative;
  user-select:none;
  transition:transform .18s ease, box-shadow .12s ease;
  overflow: hidden;
}

/* Source and Well Images */
.cell.source-clean,
.cell.source-dirty,
.cell.well {
  background: #f8fafc;
  border: 2px solid #e5e7eb;
}

.cell img {
  width: 70%;
  height: 70%;
  object-fit: contain;
}

.cell.source-clean img {
  filter: hue-rotate(180deg) brightness(1.2);
}

.cell.source-dirty img {
  filter: hue-rotate(90deg) sepia(0.5);
}

/* Minimalist pipe styling */
.pipe {
  width: 100%;
  height: 100%;
  position: relative;
  background: #f8fafc;
}

.pipe::before {
  content: '';
  position: absolute;
  background: #d1d5db;
  transition: background-color 0.3s ease;
}

/* Straight pipe (I) */
.pipe.straight.vertical::before {
  width: 25%;
  height: 100%;
  left: 37.5%;
  top: 0;
}

.pipe.straight.horizontal::before {
  width: 100%;
  height: 25%;
  left: 0;
  top: 37.5%;
}

/* Elbow pipe (L) */
.pipe.elbow::before {
  width: 25%;
  height: 50%;
  background: #d1d5db;
}

.pipe.elbow.top-right::before {
  top: 0;
  left: 37.5%;
  height: 60%;
}
.pipe.elbow.top-right::after {
  content: '';
  position: absolute;
  width: 60%;
  height: 25%;
  top: 37.5%;
  left: 37.5%;
  background: #d1d5db;
}

.pipe.elbow.right-bottom::before {
  top: 37.5%;
  left: 37.5%;
  width: 60%;
  height: 25%;
}
.pipe.elbow.right-bottom::after {
  content: '';
  position: absolute;
  width: 25%;
  height: 60%;
  top: 37.5%;
  left: 37.5%;
  background: #d1d5db;
}

.pipe.elbow.bottom-left::before {
  top: 37.5%;
  left: 15%;
  width: 60%;
  height: 25%;
}
.pipe.elbow.bottom-left::after {
  content: '';
  position: absolute;
  width: 25%;
  height: 60%;
  top: 0;
  left: 37.5%;
  background: #d1d5db;
}

.pipe.elbow.left-top::before {
  top: 0;
  left: 37.5%;
  width: 25%;
  height: 60%;
}
.pipe.elbow.left-top::after {
  content: '';
  position: absolute;
  width: 60%;
  height: 25%;
  top: 37.5%;
  left: 15%;
  background: #d1d5db;
}

/* Tee pipe (T) */
.pipe.tee::before {
  width: 25%;
  height: 100%;
  left: 37.5%;
  top: 0;
}
.pipe.tee::after {
  content: '';
  position: absolute;
  background: #d1d5db;
}

.pipe.tee.top::after {
  width: 100%;
  height: 25%;
  top: 37.5%;
  left: 0;
}

.pipe.tee.right::after {
  width: 60%;
  height: 25%;
  top: 37.5%;
  left: 37.5%;
}

.pipe.tee.bottom::after {
  width: 100%;
  height: 25%;
  top: 37.5%;
  left: 0;
}

.pipe.tee.left::after {
  width: 60%;
  height: 25%;
  top: 37.5%;
  left: 15%;
}

/* Cross pipe (X) */
.pipe.cross::before {
  width: 25%;
  height: 100%;
  left: 37.5%;
  top: 0;
}
.pipe.cross::after {
  content: '';
  position: absolute;
  width: 100%;
  height: 25%;
  top: 37.5%;
  left: 0;
  background: #d1d5db;
}

/* Connected states */
.cell.connected-clean .pipe::before,
.cell.connected-clean .pipe::after {
  background: var(--brand-blue) !important;
}

.cell.connected-dirty .pipe::before,
.cell.connected-dirty .pipe::after {
  background: var(--brand-green) !important;
}

/* Blocker */
.cell.blocker .pipe {
  background: #f3f4f6;
}
.cell.blocker .pipe::before {
  content: 'âœ–';
  position: absolute;
  width: 100%;
  height: 100%;
  background: transparent !important;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #d1d5db;
  font-size: 1.2em;
}

.cell:focus{outline:3px solid #a5d8ff}
.hint{opacity:.7; margin:8px 0 0}

.modal{position:fixed; inset:0; display:grid; place-items:center; background:rgba(15,23,42,.35); padding:20px}
.hidden{display:none}
.modalCard{width:min(520px,92vw); background:#fff; border-radius:16px; box-shadow:0 20px 60px rgba(2,6,23,.2); border:1px solid #e5e7eb; padding:20px 18px 16px; position:relative}
.modalTitle{margin:2px 0 8px; font-family: "Kazimir", serif !important;}
.modalBody{opacity:.9}
.modalActions{display:flex; gap:10px; justify-content:flex-end; margin-top:18px}
.xBtn{position:absolute; right:10px; top:10px; border:none; background:transparent; font-size:18px; cursor:pointer; padding:6px; border-radius:10px}
.xBtn:hover{background:#f3f4f6}

.win{box-shadow:0 0 0 3px var(--accent) inset}
.lose{box-shadow:0 0 0 3px var(--danger) inset}

/* Timer warning */
.timer.warning {
  color: var(--danger);
  animation: pulse 1s infinite;
}

@keyframes pulse {
  0% { opacity: 1; }
  50% { opacity: 0.5; }
  100% { opacity: 1; }
}

.title-logo{
  width:240px;
  height:auto;
  display:block;
  margin: 0 auto 8px;
}